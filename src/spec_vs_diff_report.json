{
  "kind": "spec_vs_diff_report",
  "version": "1.0",
  "generatedAt": "2026-02-13T19:31:07.885Z",
  "summary": "Diff implements a Combine-focused frontend with guest localStorage support, entry form/history/detail/trend charts, benchmark comparisons, share card/public pages, and backend type/state scaffolding with migration. However, several acceptance criteria appear incomplete: signed-in note persistence, benchmark coverage for all drills shown, and share-link copying outside published/public mode. Backend API details for Combine CRUD/publish are truncated, so full REQ-23 compliance can’t be confirmed from the provided diff summary.",
  "missing_requirements": [
    {
      "id": "REQ-18",
      "requirement": "Each saved Combine entry includes a timestamp/date and an optional note field (for both signed-in backend and guest local).",
      "reason": "Guest storage includes `note`, but the signed-in save path does not send `note` to the backend, and the backend CombineResult type shown does not include a `note` field—so backend persistence of notes is not evidenced.",
      "evidence": [
        "frontend/src/hooks/useCombine.ts (mutationFn for saveCombineResult omits `note`)",
        "backend/main.mo (CombineResult type has no `note` field in shown snippet)",
        "backend/migration.mo (CombineResult type has no `note` field)"
      ]
    },
    {
      "id": "REQ-20",
      "requirement": "Each drill shown in the entry detail view includes a benchmark reference value or range and accessible comparison text.",
      "reason": "Entry detail includes 10-yard and 20-yard split drills (`dash10yd`, `dash20yd`), but the BENCHMARKS table only defines benchmarks for dash40yd, vertical, broad, bench, shuttle, and threeCone—so splits will render no benchmark comparison.",
      "evidence": [
        "frontend/src/pages/combine/EntryDetail.tsx (drills include dash10yd, dash20yd)",
        "frontend/src/utils/combineBenchmarks.ts (no entries for dash10yd or dash20yd)",
        "frontend/src/components/combine/BenchmarkComparison.tsx (returns null if benchmark missing)"
      ]
    },
    {
      "id": "REQ-21",
      "requirement": "Allow a user to generate a shareable Combine Card view for a selected entry and copy a share link.",
      "reason": "The Share page only shows a copyable link UI when the user is authenticated and the entry is public. For guest mode (and authenticated-but-private), it instructs “Screenshot to share” and does not present a copy link, so “copy a share link” is not implemented for those cases in the shown UI.",
      "evidence": [
        "frontend/src/pages/combine/ShareCard.tsx (copy link input/button only rendered when `isAuthenticated && isPublic`)"
      ]
    },
    {
      "id": "REQ-23",
      "requirement": "Backend exposes methods to create/list/get Combine entries scoped to caller, plus publish/unpublish and public-read fetch for share links and a simple public feed, with access control.",
      "reason": "Frontend calls several backend methods (`getUserCombineResults`, `getCombineResultById`, `saveCombineResult`, `toggleCombinePublicState`, `deleteCombineResult`, plus public-feed/public-entry queries), but the diff summary’s backend/main.mo content is truncated before any Combine methods are shown, so these required backend endpoints and access control cannot be verified from the provided evidence.",
      "evidence": [
        "frontend/src/hooks/useCombine.ts (calls actor.getUserCombineResults, getCombineResultById, saveCombineResult, toggleCombinePublicState, deleteCombineResult, and public queries)",
        "backend/main.mo (truncated; only types/state shown)"
      ]
    }
  ],
  "hallucinated_features": [
    {
      "description": "Introduces or continues to include recovery/medication/check-in related modules and pages alongside the Combine tracker.",
      "reason": "BuildRequest requires refocusing navigation/landing around Combine and de-emphasizing recovery pages, but does not request additional changes to recovery feature components. The diff shows multiple recovery-related files modified, which may be unrelated to the Combine requirements (exact changes are not visible for these files in the summary).",
      "evidence": [
        "frontend/src/components/checkins/CheckInEditor.tsx (modified)",
        "frontend/src/components/checkins/CheckInTrends.tsx (modified)",
        "frontend/src/components/medications/DoseChecklistToday.tsx (modified)",
        "frontend/src/components/medications/MedicationForm.tsx (modified)",
        "frontend/src/components/meetings/MeetingForm.tsx (modified)",
        "frontend/src/components/meetings/SponsorNotes.tsx (modified)",
        "frontend/src/components/safety/CommitmentsPlanEditor.tsx (modified)",
        "frontend/src/pages/AdherenceHistory.tsx (modified)",
        "frontend/src/pages/CheckIns.tsx (modified)",
        "frontend/src/pages/CrisisHelp.tsx (modified)",
        "frontend/src/pages/MedicationDetail.tsx (modified)",
        "frontend/src/pages/Medications.tsx (modified)",
        "frontend/src/pages/Meetings.tsx (modified)"
      ]
    }
  ],
  "confidence": 0.66,
  "changed_files": [
    "backend/main.mo",
    "backend/migration.mo",
    "frontend-file-summaries.txt",
    "frontend/src/App.tsx",
    "frontend/src/components/checkins/CheckInEditor.tsx",
    "frontend/src/components/checkins/CheckInTrends.tsx",
    "frontend/src/components/combine/BenchmarkComparison.tsx",
    "frontend/src/components/combine/CombineEntryForm.tsx",
    "frontend/src/components/combine/CombineTrendChart.tsx",
    "frontend/src/components/combine/CombineTrendsPanel.tsx",
    "frontend/src/components/layout/AppShell.tsx",
    "frontend/src/components/medications/DoseChecklistToday.tsx",
    "frontend/src/components/medications/MedicationForm.tsx",
    "frontend/src/components/meetings/MeetingForm.tsx",
    "frontend/src/components/meetings/SponsorNotes.tsx",
    "frontend/src/components/safety/CommitmentsPlanEditor.tsx",
    "frontend/src/components/safety/Disclaimers.tsx",
    "frontend/src/hooks/useCombine.ts",
    "frontend/src/hooks/useQueries.ts",
    "frontend/src/index.css",
    "frontend/src/pages/AdherenceHistory.tsx",
    "frontend/src/pages/CheckIns.tsx",
    "frontend/src/pages/CrisisHelp.tsx",
    "frontend/src/pages/Landing.tsx",
    "frontend/src/pages/MedicationDetail.tsx",
    "frontend/src/pages/Medications.tsx",
    "frontend/src/pages/Meetings.tsx",
    "frontend/src/pages/Onboarding.tsx",
    "frontend/src/pages/Program.tsx",
    "frontend/src/pages/ProgramStepDetail.tsx",
    "frontend/src/pages/Settings.tsx",
    "frontend/src/pages/SettingsDataExport.tsx",
    "frontend/src/pages/StayingSafeOutOfTrouble.tsx",
    "frontend/src/pages/Today.tsx",
    "frontend/src/pages/combine/Dashboard.tsx",
    "frontend/src/pages/combine/EntryDetail.tsx",
    "frontend/src/pages/combine/History.tsx",
    "frontend/src/pages/combine/NewEntry.tsx",
    "frontend/src/pages/combine/PublicEntry.tsx",
    "frontend/src/pages/combine/Published.tsx",
    "frontend/src/pages/combine/ShareCard.tsx",
    "frontend/src/utils/combineBenchmarks.ts",
    "frontend/src/utils/combineGuestStorage.ts",
    "frontend/src/utils/combineValidation.ts",
    "frontend/src/utils/exporters.ts",
    "frontend/src/utils/reminders.ts",
    "frontend/src/utils/userScopedStorage.ts",
    "frontend/tailwind.config.js",
    "project_state.json"
  ]
}